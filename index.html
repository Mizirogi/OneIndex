<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>一个主页</title>
    <script src="js/weather-icon.js"></script>
    <!-- layui引入 -->
    <script src="layui/layui.js"></script>
    <link rel="stylesheet" href="layui/css/layui.css" />
    <link rel="stylesheet" href="css/basic.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <div id="main-container">
      <div class="weather-container">
        <div class="weather-icon">
          
        </div>
        <div id="tem"></div>
        <div id="tips"></div>
        <ul id="box"></ul>
      </div>

      <div class="serach-container">
        <div
          class="layui-tab layui-tab-brief serach-area"
          lay-filter="serachTabs"
        >
          <ul class="layui-tab-title">
            <li class="layui-this">百度</li>
            <li>谷歌</li>
            <li>必应</li>
            <li>Lookao</li>
          </ul>
          <div class="layui-tab-content">
            <form
              id="search-form"
              action="https://www.baidu.com/s?tn=baidu"
              target="_blank"
              method="get"
            >
              <input
                class="serach"
                type="serach"
                id="keyword"
                name="word"
                placeholder="吾将上下而求索"
              />
              <input
                class="float-right"
                id="serach-submint"
                type="submit"
                value="搜索"
              />
            </form>
          </div>
          <!-- <div class="layui-tab-item layui-show">
              <form action="https://www.baidu.com/s?tn=baidu" target="_blank" method="get">
              <input
                class="serach"
                type="serach"
                id="keyword"
                name="word"
                placeholder="吾将上下而求索"
              />
              <input class="float-right" type="submit" value="搜索">
            </form>
            </div>
            <div class="layui-tab-item">2</div>
            <div class="layui-tab-item">3</div>
            <div class="layui-tab-item">4</div> -->
        </div>
      </div>
    </div>
  </body>
</html>

<script async>
  //一般直接写在一个js文件中
  var url = [
    "https://www.baidu.com/s?tn=baidu",
    "https://www.google.com/search",
    "https://cn.bing.com/search",
    "https://lookao.com/search"
  ];
  var weatherIcon = {
    xue: snowCloud,
    qing: sunshine,
    yin: sunCloud,
    yun: cloud,
    yu: rainCloud
  };
  layui.use(["layer", "form", "element", "jquery"], function() {
    var layer = layui.layer,
      form = layui.form,
      element = layui.element,
      $ = layui.$;

    //   for (let i = 0; i < 4; i++) {
    //   element.tabAdd("serachTabs", {
    //     title: "111",
    //     content: `<p>asdasdasdasd</p>`, //支持传入html
    //     id: i+1
    //   });
    //   element.tabChange('serachTabs', '1')
    // }
    element.on("tab(serachTabs)", function(data) {
      console.log(data.index); //得到当前Tab的所在下标
      $("#search-form").attr("action", url[data.index]);
      data.index
        ? $("#keyword").attr("name", "q")
        : $("#keyword").attr("name", "wd");
    });

    $.ajax({
      type: "GET",
      url: "https://www.tianqiapi.com/api/",
      data: "version=v1&appid=98595487&appsecret=dA4p3WUt",
      dataType: "JSON",
      error: function() {
        layer.msg("获取天气失败");
      },
      success: function(res) {
        $(".weather-icon").append(weatherIcon[res.data[0].wea_img]);
        //$("#box").append("<li>City: " + res.city + "</li>");
        //$("#box").append("<li>Weather: " + res.data[0].wea + "</li>");
        $("#tem").append(res.data[0].tem);
       
        // 遍历数组
        $("#tem").on({
          mouseenter: function() {
            var that = this;
            tips = layer.tips(res.data[0].air_tips, "#tem", {
              tips: [3, "#909090"],
              area: 'auto'
            });
          },
          mouseleave: function() {
            layer.close(tips);
          }
        });

        for (var i = 0; i < res.data[0].hours.length; i++) {
          $("#hours").append(
            "<li>" +
              (i + 1) +
              ": 时间: " +
              res.data[0].hours[i].day +
              " 气温: " +
              res.data[0].hours[i].tem +
              " </li >"
          );
        }
      }
    });
    $(".serach").keypress(function(e) {
      if (e.which == 13) {
        let wd = encodeURI($(this).val());
        console.log(encodeURI($(this).val()));
        window.location.href = `https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=baidu&wd=${wd}&tn=baidulocal`;
      }
    });

    function mixSearch() {
      // https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&tn=baidu&wd=%E6%95%B0%E6%8D%AE&tn=baidulocal
      var okeyword = $("keyword");
      var oForm = $("searchForm");
      //提交给百度，构造地址参数
      oForm.action = "http://www.baidu.com/s";
      okeyword.name = "wd";
      oForm.method = "get";
      oForm.target = "baiduFrame";
      oForm.submit();
      //提交给bing，构造地址参数
      oForm.action = "http://hk.bing.com/search";
      okeyword.name = "q";
      oForm.method = "get";
      oForm.target = "bingFrame";
      oForm.submit();
    }
  });
</script>
<style>
  .layui-tab-title li {
    color: #9a9a9a;
  }
  .layui-tab-brief > .layui-tab-title .layui-this {
    color: #000;
  }
</style>
